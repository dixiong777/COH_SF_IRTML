TITLE: Assess polytomous IADL items using GRM
DATA: FILE IS " C:\Users\y9lyu\Desktop\data_PAR_IRT_head.csv";
VARIABLE: NAMES ARE 
ID P_WORRY P_SOCNET1E P_SOCNET1B P_SOCCOM2 P_SH1 
P_SELFEFF7 P_SELFEFF2 P_SELFEFF1
P_SELFEFF P_SCHMISS P_OHEFFECT P_COLOR_BAD P_CHOPG 
P_CHOPF P_CHOPE P_CHOPD P_CHOPC P_CHOPB P_CHOPA 
P_AFRAID P_ACCESS6 P_ACCESS1;

!Updates: Decay Model SF
!USEVARIABLES ARE P_CHOPF P_CHOPG P_CHOPB P_CHOPA
!P_CHOPC P_CHOPE P_CHOPD P_SCHMISS P_SELFEFF2 P_SH1;

!CATEGORICAL ARE P_CHOPF P_CHOPG P_CHOPB P_CHOPA
!P_CHOPC P_CHOPE P_CHOPD P_SCHMISS P_SELFEFF2 P_SH1;

!Updates: Referral Model SF
USEVARIABLES ARE P_CHOPF P_CHOPE P_CHOPA P_CHOPC
P_SCHMISS P_ACCESS6 P_SH1 P_AFRAID P_SOCCOM2 P_SELFEFF7;

CATEGORICAL ARE P_CHOPF P_CHOPE P_CHOPA P_CHOPC
P_SCHMISS P_ACCESS6 P_SH1 P_AFRAID P_SOCCOM2 P_SELFEFF7;


!Updates: Decay Model LF
!USEVARIABLES ARE P_WORRY P_SOCNET1E P_SOCNET1B 
!P_SH1 P_SELFEFF2 P_SELFEFF P_SCHMISS
!P_OHEFFECT P_CHOPG P_CHOPF P_CHOPE P_CHOPD P_CHOPC P_CHOPB 
!P_CHOPA P_AFRAID P_ACCESS1;

!CATEGORICAL ARE P_WORRY P_SOCNET1E P_SOCNET1B 
!P_SH1 P_SELFEFF2 P_SELFEFF P_SCHMISS
!P_OHEFFECT P_CHOPG P_CHOPF P_CHOPE P_CHOPD P_CHOPC P_CHOPB 
!P_CHOPA P_AFRAID P_ACCESS1;

!Updates: Referral Model LF
!USEVARIABLES ARE P_WORRY P_SOCNET1B P_SOCCOM2 P_SH1 
!P_SELFEFF7 P_SELFEFF1 P_SCHMISS P_OHEFFECT
!P_COLOR_BAD P_CHOPF P_CHOPE P_CHOPC P_CHOPA P_AFRAID
!P_ACCESS6;

!CATEGORICAL ARE P_WORRY P_SOCNET1B P_SOCCOM2 P_SH1 
!P_SELFEFF7 P_SELFEFF1 P_SCHMISS P_OHEFFECT
!P_COLOR_BAD P_CHOPF P_CHOPE P_CHOPC P_CHOPA 
! P_AFRAID P_ACCESS6;

MISSING ARE ALL(-4);
IDVARIABLE IS ID;

ANALYSIS: ESTIMATOR IS WLSMV;
PROCESSORS = 8;
!LINK IS LOGIT;

MODEL:
! factor loadings all estimated
! Updates: Decay Model SF
!theta BY P_CHOPF* P_CHOPG P_CHOPB P_CHOPA
!P_CHOPC P_CHOPE P_CHOPD P_SCHMISS P_SELFEFF2 P_SH1;

! Updates: Referral Model SF
theta BY P_CHOPF* P_CHOPE P_CHOPA P_CHOPC
P_SCHMISS P_ACCESS6 P_SH1 P_AFRAID P_SOCCOM2 P_SELFEFF7;

! Updates: Decay Model LF
!theta BY P_WORRY* P_SOCNET1E P_SOCNET1B P_SH1 
!P_SELFEFF2 P_SELFEFF P_SCHMISS
!P_OHEFFECT P_CHOPG P_CHOPF P_CHOPE P_CHOPD P_CHOPC P_CHOPB 
!P_CHOPA P_AFRAID P_ACCESS1;

! Updates: Referral Model LF
!theta BY P_WORRY* P_SOCNET1B P_SOCCOM2 P_SH1 P_SELFEFF7 
!P_SELFEFF1 P_SCHMISS P_OHEFFECT
!P_COLOR_BAD P_CHOPF P_CHOPE P_CHOPC P_CHOPA P_AFRAID P_ACCESS6;

! Factor mean = 0  and variance = 1 for identification.
[theta@0];theta@1;

OUTPUT: TECH1 TECH5 TECH8;

SAVEDATA: SAVE = FSCORES; ! SAVE FACTOR SCORES (THETAS)
FILE IS theta.csv;

PLOT: TYPE IS PLOT1;   !sample descriptive
TYPE IS PLOT2;    !IRT relevant curves
TYPE IS PLOT3;! Descriptives for theta. 
